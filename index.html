<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Delta Exchange — Options Trading</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --bg-base: #101013;
      --bg-surface: #1A1A1F;
      --bg-surface-alt: #141418;
      --bg-elevated: #1E1E24;
      --bg-header: #0D0D10;
      --bg-row-hover: #1A1A22;
      --bg-row-highlight: #1C1C28;
      --bg-atm: #1E1A14;
      --bg-itm-call: rgba(0, 210, 106, 0.04);
      --bg-itm-put: rgba(255, 59, 59, 0.04);

      --text-primary: #FFFFFF;
      --text-secondary: #A0A0A8;
      --text-tertiary: #6B6B76;
      --text-dim: #50505A;

      --accent: #2894F9;
      --accent-muted: rgba(40, 148, 249, 0.15);

      --buy: #00D26A;
      --buy-muted: rgba(0, 210, 106, 0.12);
      --sell: #FF3B3B;
      --sell-muted: rgba(255, 59, 59, 0.12);

      --border: #2A2A32;
      --border-subtle: #1E1E26;
      --border-strong: #3A3A44;

      --warning: #FFB020;

      --font: "Roboto", "Helvetica", "Arial", sans-serif;
      --transition: 200ms cubic-bezier(0.4, 0, 0.2, 1);
    }

    body {
      font-family: var(--font);
      background: var(--bg-base);
      color: var(--text-primary);
      font-size: 13px;
      line-height: 1.4;
      overflow: hidden;
      height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    /* ── Top Nav ─────────────────────────────────── */
    .top-nav {
      display: flex;
      align-items: center;
      height: 40px;
      background: var(--bg-header);
      border-bottom: 1px solid var(--border);
      padding: 0 16px;
      gap: 16px;
    }
    .nav-tab {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 0 12px;
      height: 40px;
      font-size: 12px;
      font-weight: 500;
      color: var(--text-tertiary);
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all var(--transition);
    }
    .nav-tab:hover { color: var(--text-secondary); }
    .nav-tab.active { color: var(--text-primary); border-bottom-color: var(--accent); }
    .nav-tab svg { width: 14px; height: 14px; fill: currentColor; opacity: 0.7; }
    .nav-divider { width: 1px; height: 20px; background: var(--border); }
    .asset-toggle {
      display: flex;
      border-radius: 4px;
      overflow: hidden;
      border: 1px solid var(--border);
    }
    .asset-btn {
      padding: 4px 16px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-tertiary);
      cursor: pointer;
      background: transparent;
      transition: all var(--transition);
      font-family: var(--font);
      border: none;
    }
    .asset-btn.active { background: var(--accent); color: #fff; }
    .asset-btn:hover:not(.active) { color: var(--text-secondary); }

    .nav-tab-label { text-transform: none; letter-spacing: 0; }

    /* ── Date Bar ────────────────────────────────── */
    .date-bar {
      display: flex;
      align-items: center;
      height: 32px;
      background: var(--bg-surface-alt);
      border-bottom: 1px solid var(--border);
      padding: 0 12px;
      gap: 2px;
    }
    .date-tab {
      padding: 4px 10px;
      font-size: 11px;
      font-weight: 500;
      color: var(--text-tertiary);
      cursor: pointer;
      border-radius: 3px;
      transition: all var(--transition);
      white-space: nowrap;
    }
    .date-tab:hover { color: var(--text-secondary); }
    .date-tab.active { background: var(--accent); color: #fff; }
    .date-spacer { flex: 1; }
    .date-nav {
      display: flex;
      gap: 4px;
      margin-left: 8px;
    }
    .date-nav button {
      width: 22px;
      height: 22px;
      border: 1px solid var(--border);
      border-radius: 3px;
      background: transparent;
      color: var(--text-tertiary);
      cursor: pointer;
      font-size: 11px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .date-nav button:hover { border-color: var(--text-tertiary); color: var(--text-secondary); }

    /* ── Main Layout ─────────────────────────────── */
    .main {
      display: flex;
      height: calc(100vh - 72px);
    }

    /* ── Option Chain (Left 50%) ─────────────────── */
    .panel-left {
      width: 50%;
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .oc-info-bar {
      display: flex;
      align-items: center;
      height: 32px;
      padding: 0 12px;
      background: var(--bg-surface-alt);
      border-bottom: 1px solid var(--border);
      font-size: 12px;
      gap: 16px;
    }
    .oc-info-bar .side-label {
      font-weight: 600;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }
    .oc-info-bar .side-label.calls { color: var(--text-secondary); }
    .oc-info-bar .side-label.puts { color: var(--text-secondary); margin-left: auto; }
    .oc-info-bar .price-info { color: var(--text-secondary); }
    .oc-info-bar .price-info .price { color: var(--buy); font-weight: 600; }
    .oc-info-bar .tte { color: var(--text-tertiary); font-size: 11px; }

    /* Option chain table */
    .oc-wrap {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
    }
    .oc-wrap::-webkit-scrollbar { width: 5px; }
    .oc-wrap::-webkit-scrollbar-track { background: transparent; }
    .oc-wrap::-webkit-scrollbar-thumb { background: var(--border-strong); border-radius: 3px; }

    .oc-table {
      width: 100%;
      border-collapse: collapse;
      font-variant-numeric: tabular-nums;
      table-layout: fixed;
    }
    .oc-table thead { position: sticky; top: 0; z-index: 3; }
    .oc-table th {
      background: var(--bg-surface-alt);
      color: var(--text-tertiary);
      font-size: 10px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      padding: 4px 6px 2px;
      border-bottom: 1px solid var(--border);
      white-space: nowrap;
      vertical-align: bottom;
    }
    .oc-table th .sub {
      display: block;
      font-size: 9px;
      font-weight: 400;
      color: var(--text-dim);
      text-transform: none;
      letter-spacing: 0;
      margin-top: 1px;
    }
    .oc-table th.strike-th {
      background: var(--bg-elevated);
      color: var(--text-secondary);
      text-align: center;
    }
    .oc-table th.call-th { text-align: right; }
    .oc-table th.put-th { text-align: left; }
    .oc-table th.oi-th { text-align: right; }
    .oc-table th.oi-th-put { text-align: left; }

    .oc-table td {
      padding: 3px 6px;
      font-size: 12px;
      border-bottom: 1px solid var(--border-subtle);
      white-space: nowrap;
      vertical-align: middle;
      line-height: 1.3;
    }
    .oc-table tr:hover td { background: var(--bg-row-hover) !important; }

    /* Cell types */
    .oc-table .c-r { text-align: right; }
    .oc-table .c-l { text-align: left; }
    .oc-table .c-c { text-align: center; }

    .oc-table .strike-cell {
      text-align: center;
      font-weight: 600;
      font-size: 12px;
      color: var(--text-primary);
      background: var(--bg-surface-alt);
      border-left: 1px solid var(--border);
      border-right: 1px solid var(--border);
    }

    /* Price + IV dual-line cell */
    .price-line {
      font-size: 12px;
      font-weight: 400;
      color: var(--text-primary);
    }
    .iv-line {
      font-size: 10px;
      color: var(--text-dim);
      margin-top: 0px;
    }
    .ask-price .price-line { color: var(--buy); }
    .bid-price-put .price-line { color: var(--buy); }
    .ask-price-put .price-line { color: var(--sell); }

    .oi-val { color: var(--text-tertiary); font-size: 11px; }
    .qty-val { color: var(--text-secondary); font-size: 12px; }

    /* ATM row */
    .oc-table tr.atm td { background: var(--bg-atm); }
    .oc-table tr.atm td.strike-cell {
      background: var(--accent-muted);
      color: var(--accent);
      font-weight: 700;
    }

    /* ITM shading */
    .oc-table tr.itm-call td.call-side { background: var(--bg-itm-call); }
    .oc-table tr.itm-put td.put-side { background: var(--bg-itm-put); }

    /* ── Right Panel ─────────────────────────────── */
    .panel-right {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* Chart */
    .chart-panel {
      flex: 1;
      min-height: 0;
      border-bottom: 1px solid var(--border);
      display: flex;
      flex-direction: column;
    }
    .chart-toolbar {
      display: flex;
      align-items: center;
      padding: 6px 12px;
      gap: 10px;
      background: var(--bg-surface-alt);
      border-bottom: 1px solid var(--border);
      height: 34px;
    }
    .chart-toolbar .pair {
      font-size: 13px;
      font-weight: 600;
      color: var(--text-primary);
    }
    .chart-toolbar .tf {
      font-size: 11px;
      padding: 3px 8px;
      border-radius: 3px;
      color: var(--text-tertiary);
      cursor: pointer;
      transition: all var(--transition);
    }
    .chart-toolbar .tf:hover { color: var(--text-secondary); }
    .chart-toolbar .tf.active { background: var(--accent-muted); color: var(--accent); }
    .chart-area {
      flex: 1;
      position: relative;
      background: var(--bg-base);
    }
    .chart-area canvas { display: block; }

    /* Positions */
    .positions-panel {
      height: 38%;
      min-height: 160px;
      display: flex;
      flex-direction: column;
    }
    .positions-tabs {
      display: flex;
      align-items: center;
      padding: 0 12px;
      height: 34px;
      background: var(--bg-surface-alt);
      border-bottom: 1px solid var(--border);
      gap: 2px;
    }
    .pos-tab {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-tertiary);
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 4px;
      transition: all var(--transition);
    }
    .pos-tab:hover { color: var(--text-secondary); }
    .pos-tab.active { color: var(--accent); background: var(--accent-muted); }
    .pos-tab .count {
      display: inline-block;
      background: var(--accent);
      color: #fff;
      font-size: 9px;
      font-weight: 600;
      padding: 1px 5px;
      border-radius: 8px;
      margin-left: 3px;
      vertical-align: 1px;
    }

    .positions-wrap {
      flex: 1;
      overflow-y: auto;
    }
    .positions-wrap::-webkit-scrollbar { width: 5px; }
    .positions-wrap::-webkit-scrollbar-track { background: transparent; }
    .positions-wrap::-webkit-scrollbar-thumb { background: var(--border-strong); border-radius: 3px; }

    .pos-table {
      width: 100%;
      border-collapse: collapse;
      font-variant-numeric: tabular-nums;
    }
    .pos-table th {
      position: sticky;
      top: 0;
      background: var(--bg-surface-alt);
      color: var(--text-tertiary);
      font-size: 10px;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.04em;
      padding: 6px 10px;
      text-align: left;
      border-bottom: 1px solid var(--border);
      white-space: nowrap;
    }
    .pos-table td {
      padding: 7px 10px;
      font-size: 12px;
      border-bottom: 1px solid var(--border-subtle);
      white-space: nowrap;
    }
    .pos-table tr:hover td { background: var(--bg-row-hover); }
    .side-long { color: var(--buy); font-weight: 600; }
    .side-short { color: var(--sell); font-weight: 600; }
    .green { color: var(--buy); }
    .red { color: var(--sell); }
    .btn-close {
      background: transparent;
      border: 1px solid var(--sell);
      color: var(--sell);
      font-size: 10px;
      padding: 2px 10px;
      border-radius: 3px;
      cursor: pointer;
      font-family: var(--font);
      transition: all var(--transition);
    }
    .btn-close:hover { background: var(--sell); color: #fff; }
  </style>
</head>
<body>

  <!-- Top Nav -->
  <div class="top-nav">
    <div class="nav-tab active">
      <svg viewBox="0 0 16 16"><rect x="1" y="1" width="6" height="6" rx="1"/><rect x="9" y="1" width="6" height="6" rx="1"/><rect x="1" y="9" width="6" height="6" rx="1"/><rect x="9" y="9" width="6" height="6" rx="1"/></svg>
      <span class="nav-tab-label">Option Chain</span>
    </div>
    <div class="nav-tab">
      <svg viewBox="0 0 16 16"><polyline points="1,12 4,5 7,8 10,3 14,7" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
      <span class="nav-tab-label">Chart</span>
    </div>
    <div class="nav-divider"></div>
    <div class="asset-toggle">
      <button class="asset-btn active">BTC</button>
      <button class="asset-btn">ETH</button>
    </div>
  </div>

  <!-- Date Bar -->
  <div class="date-bar">
    <div class="date-tab">16 Feb 26</div>
    <div class="date-tab">17 Feb 26</div>
    <div class="date-tab">18 Feb 26</div>
    <div class="date-tab">20 Feb 26</div>
    <div class="date-tab active">27 Feb 26</div>
    <div class="date-tab">06 Mar 26</div>
    <div class="date-tab">27 Mar 26</div>
    <div class="date-tab">24 Apr 26</div>
    <div class="date-spacer"></div>
    <div class="date-nav">
      <button>&lsaquo;</button>
      <button>&rsaquo;</button>
    </div>
  </div>

  <!-- Main -->
  <div class="main">

    <!-- Left: Option Chain 50% -->
    <div class="panel-left">
      <div class="oc-info-bar">
        <span class="side-label calls">Calls</span>
        <span class="price-info">BTC <span class="price">$70,320.9</span></span>
        <span class="tte">Time to Expiry <strong style="color:var(--text-secondary)">11d:23h:35m</strong></span>
        <span class="side-label puts">Puts</span>
      </div>
      <div class="oc-wrap">
        <table class="oc-table">
          <thead>
            <tr>
              <th class="call-th">Bid<span class="sub">(Price / IV)</span></th>
              <th class="call-th">Mark<span class="sub">(Price / IV)</span></th>
              <th class="call-th">Ask<span class="sub">(Price / IV)</span></th>
              <th class="call-th">Ask Qty<span class="sub">BTC</span></th>
              <th class="oi-th">OI</th>
              <th class="strike-th">Strike &#x25BC;</th>
              <th class="oi-th-put">OI</th>
              <th class="put-th">Bid Qty<span class="sub">BTC</span></th>
              <th class="put-th">Bid<span class="sub">(Price / IV)</span></th>
              <th class="put-th">Mark<span class="sub">(Price / IV)</span></th>
              <th class="put-th">Ask<span class="sub">(Price / IV)</span></th>
            </tr>
          </thead>
          <tbody id="oc-body"></tbody>
        </table>
      </div>
    </div>

    <!-- Right: Chart + Positions 50% -->
    <div class="panel-right">
      <div class="chart-panel">
        <div class="chart-toolbar">
          <span class="pair">BTC-27FEB26-70000-C</span>
          <span class="tf">1m</span>
          <span class="tf">5m</span>
          <span class="tf active">15m</span>
          <span class="tf">1H</span>
          <span class="tf">4H</span>
          <span class="tf">1D</span>
        </div>
        <div class="chart-area">
          <canvas id="chart-canvas"></canvas>
        </div>
      </div>

      <div class="positions-panel">
        <div class="positions-tabs">
          <div class="pos-tab active">Positions <span class="count">3</span></div>
          <div class="pos-tab">Open Orders <span class="count">1</span></div>
          <div class="pos-tab">Order History</div>
          <div class="pos-tab">Trade History</div>
        </div>
        <div class="positions-wrap">
          <table class="pos-table">
            <thead>
              <tr>
                <th>Contract</th>
                <th>Side</th>
                <th>Size</th>
                <th>Entry Price</th>
                <th>Mark Price</th>
                <th>Liq. Price</th>
                <th>PnL</th>
                <th>ROE %</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="pos-body"></tbody>
          </table>
        </div>
      </div>
    </div>

  </div>

  <script>
    /* ── Option Chain Data (matching screenshot) ── */
    const spotPrice = 70320.9;
    const strikes = [
      { strike: 66500, cBid: 4919.0, cBidIV: '53.3%', cMark: 4956.1, cMarkIV: '53.7%', cAsk: 4990.0, cAskIV: '53.3%', cAskQty: 4.939, cOI: '$49.82K', pOI: '$52.68K', pBidQty: 7.319, pBid: 1026.2, pBidIV: '50.2%', pMark: 1042.0, pMarkIV: '50.5%', pAsk: 1060.0, pAskIV: '4.8' },
      { strike: 67000, cBid: 4647.0, cBidIV: '51.4%', cMark: 4579.4, cMarkIV: '52.2%', cAsk: 4614.0, cAskIV: '50.9%', cAskQty: 5.196, cOI: '$339.12K', pOI: '$538.26K', pBidQty: 7.880, pBid: 1132.0, pBidIV: '49.5%', pMark: 1148.5, pMarkIV: '49.8%', pAsk: 1106.0, pAskIV: '4.8' },
      { strike: 67500, cBid: 4183.0, cBidIV: '50.7%', cMark: 4215.4, cMarkIV: '51.5%', cAsk: 4247.0, cAskIV: '50.2%', cAskQty: 4.948, cOI: '$48.67K', pOI: '$72.54K', pBidQty: 7.319, pBid: 1266.0, pBidIV: '49.0%', pMark: 1283.3, pMarkIV: '49.3%', pAsk: 1301.0, pAskIV: '4.9' },
      { strike: 68000, cBid: 3820.0, cBidIV: '49.5%', cMark: 3863.8, cMarkIV: '50.8%', cAsk: 3886.0, cAskIV: '49.4%', cAskQty: 4.880, cOI: '$108.29K', pOI: '$326.81K', pBidQty: 7.357, pBid: 1411.0, pBidIV: '47.9%', pMark: 1429.9, pMarkIV: '48.2%', pAsk: 1448.0, pAskIV: '4.8' },
      { strike: 68500, cBid: 3500.0, cBidIV: '48.5%', cMark: 3527.7, cMarkIV: '49.5%', cAsk: 3556.0, cAskIV: '48.6%', cAskQty: 4.939, cOI: '$124.18K', pOI: '$91.19K', pBidQty: 7.319, pBid: 1577.0, pBidIV: '47.1%', pMark: 1594.7, pMarkIV: '47.4%', pAsk: 1614.0, pAskIV: '4.3' },
      { strike: 69000, cBid: 3184.0, cBidIV: '47.2%', cMark: 3210.5, cMarkIV: '48.3%', cAsk: 3236.0, cAskIV: '47.4%', cAskQty: 5.045, cOI: '$279.88K', pOI: '$299.95K', pBidQty: 7.318, pBid: 1775.0, pBidIV: '46.5%', pMark: 1794.0, pMarkIV: '46.4%', pAsk: 1814.0, pAskIV: '4.4' },
      { strike: 69500, cBid: 2889.0, cBidIV: '46.1%', cMark: 2907.5, cMarkIV: '46.7%', cAsk: 2932.0, cAskIV: '46.3%', cAskQty: 4.879, cOI: '$176.09K', pOI: '$287.54K', pBidQty: 7.508, pBid: 1972.0, pBidIV: '46.7%', pMark: 1993.0, pMarkIV: '46.7%', pAsk: 2014.0, pAskIV: '4.4' },
      { strike: 70000, cBid: 2602.0, cBidIV: '46.1%', cMark: 2621.4, cMarkIV: '46.2%', cAsk: 2642.0, cAskIV: '45.5%', cAskQty: 5.040, cOI: '$278.74K', pOI: '$981.79K', pBidQty: 7.318, pBid: 2186.0, pBidIV: '46.7%', pMark: 2206.0, pMarkIV: '46.7%', pAsk: 2228.0, pAskIV: '4.8', atm: true },
      { strike: 70500, cBid: 2329.0, cBidIV: '46.3%', cMark: 2354.9, cMarkIV: '46.5%', cAsk: 2380.0, cAskIV: '46.3%', cAskQty: 4.880, cOI: '$55.99K', pOI: '$54.09K', pBidQty: 7.318, pBid: 2390.0, pBidIV: '46.0%', pMark: 2417.3, pMarkIV: '46.3%', pAsk: 2436.0, pAskIV: '4.8' },
      { strike: 71000, cBid: 2085.0, cBidIV: '47.2%', cMark: 2104.9, cMarkIV: '47.0%', cAsk: 2125.0, cAskIV: '48.6%', cAskQty: 5.230, cOI: '$325.65K', pOI: '$234.35K', pBidQty: 7.432, pBid: 2648.0, pBidIV: '47.0%', pMark: 2667.4, pMarkIV: '47.2%', pAsk: 2688.0, pAskIV: '4.8' },
      { strike: 71500, cBid: 1852.0, cBidIV: '46.9%', cMark: 1872.6, cMarkIV: '47.2%', cAsk: 1892.0, cAskIV: '47.0%', cAskQty: 4.879, cOI: '$162.21K', pOI: '$3.92K', pBidQty: 7.319, pBid: 2913.0, pBidIV: '46.8%', pMark: 2934.0, pMarkIV: '47.1%', pAsk: 2962.0, pAskIV: '4.8' },
      { strike: 72000, cBid: 1645.0, cBidIV: '48.5%', cMark: 1663.3, cMarkIV: '48.4%', cAsk: 1681.0, cAskIV: '48.3%', cAskQty: 5.094, cOI: '$331.71K', pOI: '$258.53K', pBidQty: 7.319, pBid: 3200.0, pBidIV: '47.7%', pMark: 3224.8, pMarkIV: '48.0%', pAsk: 3245.0, pAskIV: '8.9' },
      { strike: 72500, cBid: 1448.0, cBidIV: '49.1%', cMark: 1465.2, cMarkIV: '49.0%', cAsk: 1484.0, cAskIV: '49.2%', cAskQty: 4.870, cOI: '$92.30K', pOI: '$8.41K', pBidQty: 7.319, pBid: 3508.0, pBidIV: '48.5%', pMark: 3526.1, pMarkIV: '48.8%', pAsk: 3550.0, pAskIV: '8.4' },
      { strike: 73000, cBid: 1268.0, cBidIV: '49.8%', cMark: 1284.5, cMarkIV: '49.7%', cAsk: 1302.0, cAskIV: '49.9%', cAskQty: 5.110, cOI: '$184.92K', pOI: '$56.70K', pBidQty: 7.319, pBid: 3820.0, pBidIV: '49.2%', pMark: 3845.3, pMarkIV: '49.5%', pAsk: 3868.0, pAskIV: '8.6' },
      { strike: 73500, cBid: 1104.0, cBidIV: '50.3%', cMark: 1120.1, cMarkIV: '50.2%', cAsk: 1138.0, cAskIV: '50.5%', cAskQty: 4.930, cOI: '$67.55K', pOI: '$12.80K', pBidQty: 7.100, pBid: 4155.0, pBidIV: '49.8%', pMark: 4180.6, pMarkIV: '50.1%', pAsk: 4200.0, pAskIV: '8.2' },
      { strike: 74000, cBid: 958.0, cBidIV: '51.0%', cMark: 974.8, cMarkIV: '50.9%', cAsk: 992.0, cAskIV: '51.2%', cAskQty: 4.780, cOI: '$144.10K', pOI: '$32.00K', pBidQty: 7.319, pBid: 4506.0, pBidIV: '50.3%', pMark: 4534.2, pMarkIV: '50.6%', pAsk: 4558.0, pAskIV: '8.4' },
      { strike: 74500, cBid: 826.0, cBidIV: '51.6%', cMark: 842.3, cMarkIV: '51.5%', cAsk: 860.0, cAskIV: '51.8%', cAskQty: 5.020, cOI: '$38.40K', pOI: '$5.60K', pBidQty: 7.200, pBid: 4872.0, pBidIV: '51.0%', pMark: 4900.8, pMarkIV: '51.3%', pAsk: 4924.0, pAskIV: '8.1' },
      { strike: 75000, cBid: 710.0, cBidIV: '52.1%', cMark: 725.6, cMarkIV: '52.0%', cAsk: 742.0, cAskIV: '52.3%', cAskQty: 4.650, cOI: '$210.80K', pOI: '$18.90K', pBidQty: 7.319, pBid: 5254.0, pBidIV: '51.5%', pMark: 5282.4, pMarkIV: '51.8%', pAsk: 5308.0, pAskIV: '8.6' },
    ];

    const tbody = document.getElementById('oc-body');

    strikes.forEach(s => {
      const tr = document.createElement('tr');
      if (s.atm) tr.classList.add('atm');

      const isITMCall = s.strike < spotPrice;
      const isITMPut = s.strike > spotPrice;
      if (isITMCall) tr.classList.add('itm-call');
      if (isITMPut) tr.classList.add('itm-put');

      tr.innerHTML = `
        <td class="c-r call-side"><div class="price-line">${fmtP(s.cBid)}</div><div class="iv-line">${s.cBidIV}</div></td>
        <td class="c-r call-side"><div class="price-line" style="color:var(--text-tertiary)">${fmtP(s.cMark)}</div><div class="iv-line">${s.cMarkIV}</div></td>
        <td class="c-r call-side ask-price"><div class="price-line">${fmtP(s.cAsk)}</div><div class="iv-line">${s.cAskIV}</div></td>
        <td class="c-r call-side"><span class="qty-val">${s.cAskQty.toFixed(3)}</span></td>
        <td class="c-r call-side"><span class="oi-val">${s.cOI}</span></td>
        <td class="strike-cell">${s.strike.toLocaleString()}</td>
        <td class="c-l put-side"><span class="oi-val">${s.pOI}</span></td>
        <td class="c-l put-side"><span class="qty-val">${s.pBidQty.toFixed(3)}</span></td>
        <td class="c-l put-side bid-price-put"><div class="price-line">${fmtP(s.pBid)}</div><div class="iv-line">${s.pBidIV}</div></td>
        <td class="c-l put-side"><div class="price-line" style="color:var(--text-tertiary)">${fmtP(s.pMark)}</div><div class="iv-line">${s.pMarkIV}</div></td>
        <td class="c-l put-side ask-price-put"><div class="price-line">${fmtP(s.pAsk)}</div><div class="iv-line">${s.pAskIV}</div></td>
      `;
      tbody.appendChild(tr);
    });

    function fmtP(v) {
      return '$' + v.toLocaleString(undefined, { minimumFractionDigits: 1, maximumFractionDigits: 1 });
    }

    /* ── Positions ───────────────────────────────── */
    const positions = [
      { contract: 'BTC-27FEB26-70000-C', side: 'Long', size: '0.50 BTC', entry: '$2,480.0', mark: '$2,621.4', liq: '—', pnl: '+$70.70', roe: '+5.70%', cls: 'green' },
      { contract: 'BTC-27FEB26-68000-P', side: 'Short', size: '1.00 BTC', entry: '$1,510.0', mark: '$1,429.9', liq: '—', pnl: '+$80.10', roe: '+5.30%', cls: 'green' },
      { contract: 'BTC-27FEB26-72000-C', side: 'Long', size: '0.25 BTC', entry: '$1,680.0', mark: '$1,663.3', liq: '—', pnl: '-$4.18', roe: '-0.99%', cls: 'red' },
    ];

    const posBody = document.getElementById('pos-body');
    positions.forEach(p => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${p.contract}</td>
        <td class="${p.side === 'Long' ? 'side-long' : 'side-short'}">${p.side}</td>
        <td>${p.size}</td>
        <td>${p.entry}</td>
        <td>${p.mark}</td>
        <td>${p.liq}</td>
        <td class="${p.cls}">${p.pnl}</td>
        <td class="${p.cls}">${p.roe}</td>
        <td><button class="btn-close">Close</button></td>
      `;
      posBody.appendChild(tr);
    });

    /* ── Chart ───────────────────────────────────── */
    function drawChart() {
      const canvas = document.getElementById('chart-canvas');
      const container = canvas.parentElement;
      const dpr = window.devicePixelRatio || 1;
      const W = container.clientWidth;
      const H = container.clientHeight;
      canvas.width = W * dpr;
      canvas.height = H * dpr;
      canvas.style.width = W + 'px';
      canvas.style.height = H + 'px';
      const ctx = canvas.getContext('2d');
      ctx.scale(dpr, dpr);

      ctx.fillStyle = '#101013';
      ctx.fillRect(0, 0, W, H);

      // Grid
      ctx.strokeStyle = 'rgba(255,255,255,0.04)';
      ctx.lineWidth = 0.5;
      for (let y = 30; y < H - 20; y += 35) {
        ctx.beginPath(); ctx.moveTo(45, y); ctx.lineTo(W - 50, y); ctx.stroke();
      }
      for (let x = 45; x < W - 50; x += 50) {
        ctx.beginPath(); ctx.moveTo(x, 10); ctx.lineTo(x, H - 20); ctx.stroke();
      }

      // Candles
      const candles = [];
      let price = 2550;
      const count = Math.floor((W - 110) / 8);
      for (let i = 0; i < count; i++) {
        const o = price;
        const c = o + (Math.random() - 0.48) * 60;
        const h = Math.max(o, c) + Math.random() * 30;
        const l = Math.min(o, c) - Math.random() * 30;
        candles.push({ o, c, h, l });
        price = c;
      }

      const all = candles.flatMap(c => [c.h, c.l]);
      const mn = Math.min(...all), mx = Math.max(...all);
      const cT = 15, cB = H - 25, cH = cB - cT;
      const yP = p => cT + (1 - (p - mn) / (mx - mn)) * cH;

      candles.forEach((c, i) => {
        const x = 50 + i * 8;
        const bull = c.c >= c.o;
        const col = bull ? '#00D26A' : '#FF3B3B';
        ctx.strokeStyle = col;
        ctx.lineWidth = 1;
        ctx.beginPath(); ctx.moveTo(x, yP(c.h)); ctx.lineTo(x, yP(c.l)); ctx.stroke();
        ctx.fillStyle = col;
        const bt = yP(Math.max(c.o, c.c));
        const bb = yP(Math.min(c.o, c.c));
        ctx.fillRect(x - 2.5, bt, 5, Math.max(bb - bt, 1));
      });

      // Y-axis labels
      ctx.fillStyle = '#50505A';
      ctx.font = '10px Roboto, sans-serif';
      for (let i = 0; i <= 5; i++) {
        const p = mn + (mx - mn) * (i / 5);
        ctx.fillText('$' + p.toFixed(0), 2, yP(p) + 3);
      }

      // Current price
      const last = candles[candles.length - 1].c;
      const ly = yP(last);
      ctx.strokeStyle = '#2894F9';
      ctx.lineWidth = 0.7;
      ctx.setLineDash([3, 3]);
      ctx.beginPath(); ctx.moveTo(45, ly); ctx.lineTo(W - 50, ly); ctx.stroke();
      ctx.setLineDash([]);

      ctx.fillStyle = '#2894F9';
      const tagW = 48;
      ctx.fillRect(W - 50, ly - 8, tagW, 16);
      ctx.fillStyle = '#fff';
      ctx.font = '9px Roboto, sans-serif';
      ctx.fillText('$' + last.toFixed(1), W - 48, ly + 3);
    }

    drawChart();
    window.addEventListener('resize', drawChart);

    /* ── Tab interactions ─────────────────────────── */
    function setupTabs(selector) {
      document.querySelectorAll(selector).forEach(tab => {
        tab.addEventListener('click', () => {
          document.querySelectorAll(selector).forEach(t => t.classList.remove('active'));
          tab.classList.add('active');
        });
      });
    }
    setupTabs('.date-bar .date-tab');
    setupTabs('.asset-toggle .asset-btn');
    setupTabs('.positions-tabs .pos-tab');
    setupTabs('.chart-toolbar .tf');
    setupTabs('.top-nav .nav-tab');
  </script>
</body>
</html>
